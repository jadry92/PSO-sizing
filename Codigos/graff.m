clear all
close all

time= [0.  , 0.04, 0.08, 0.12, 0.16, 0.2 , 0.24, 0.28, 0.32, 0.36, 0.4, 0.44, 0.48, 0.52, 0.56, 0.6 , 0.64, 0.68, 0.72, 0.76, 0.8 , 0.84,0.88, 0.92, 0.96, 1.  , 1.04, 1.08, 1.12, 1.16, 1.2 , 1.24, 1.28,1.32, 1.36, 1.4 , 1.44, 1.48, 1.52, 1.56, 1.6 , 1.64, 1.68, 1.72,1.76, 1.8 , 1.84, 1.88, 1.92, 1.96, 2.  , 2.04, 2.08, 2.12, 2.16,2.2 , 2.24, 2.28, 2.32, 2.36, 2.4 , 2.44, 2.48, 2.52, 2.56, 2.6 ,2.64, 2.68, 2.72, 2.76, 2.8 , 2.84, 2.88, 2.92, 2.96, 3.  , 3.04,3.08, 3.12, 3.16];

PVpos=[0,-196.272819087832,-240.556259081956,-40.2208238515236,-231.991378932528,-220.767558904418,-222.203710320816,-202.454313052032,-164.339204691808,-154.399889568075,-165.496587762144,-102.970978923397,-160.257166035170,-141.026651215756,-136.757906221350,-157.081096843992,-127.593159927504,-163.178203303535,-112.375907972582,-107.570221026964,-96.9273837734808,-84.0013699547852,-52.9875052605373,-76.7279076821634,-41.0523049288544,-14.9444658311151,-18.3781040121352,-25.2911358939310,-25.5057965766272,-21.9061961774231,-20.8546434904660,-21.1454705305763,-21.9937349114228,-21.7306148692111,-23.7463882377172,-21.2894936437338,0,-23.3206841241335,-32.0346684156551,-24.6452487784316,-21.3219479750883,-22.9805881716998,-18.6378004486161,-42.9488120870383,-22.1139483000949,-22.4600160904142,0,-23.0785292440992,-23.1991102739153,-23.0547782768508,-23.0836065918367,-26.2278592855577,-28.3817299220895,-24.6775401582260,-23.5381963834606,-25.3062151989992,-23.2003736803035,-23.5198711423051,-22.9734490239862,-20.5096780497070,-23.3876047715457,-27.2183293497055,-23.2395204113943,-23.4139993036763,-28.1686240579855,-23.5384561577793,-24.1633647076387,-20.9667044365538,-20.0647277775668,-23.5193996384339,-23.5077903023900,-20.0506798318615,-24.2274917992669,-23.4445227917369,0,-24.7012352986627,-23.0318861880343,-22.2432404989190,-23.4727575263630,-23.5182799078671];
Bpos=[0,104.071507905450,5.63037263255859,114.957911873259,2.87766366095367,9.03440859466744,8.08950574013423,8.27315258307313,3.31213779177657,2.43802846618180,-0.808451200661876,8.17647858120927,2.45871802855481,-0.648630465245266,-0.631731064724020,-0.209769301716606,0.289948378961958,-0.468290557328661,0.0367052119465936,0.219175899093836,-0.207994221347256,-0.550875700834563,0.296000796422113,-0.352118845122631,0.111583583688086,0.124708384198962,0.131803390685085,0.0952951398663626,0.224223304710349,0.204777699225959,0.180153158404128,0.267570201382955,0.224447776233740,0.213044473888563,0.260589350741003,0.252738227422928,0,0.287947588046702,0.256645172044078,0.234878961369998,0.193909780578184,0.322634384538500,0.308400074487392,0.309328337131199,0.257234582002894,0.297826119465607,0,0.284252861716170,0.271896466417864,0.272405585208915,0.270799122726015,0.284280051628022,0.237120826023681,0.269336899526983,0.272975735832383,0.235230704270066,0.198416726627187,0.160291415408455,0.177485831455044,0.253183533027293,0.184242437075923,0.258218752105720,0.219648853760716,0.173788341142756,0.209186034644622,0.249867685116081,0.175302740413802,0.180444333678127,0.185713689084387,0.161187594845443,0.161147425183569,0.185955629159085,0.180863128181193,0.159683341561506,0,0.165430526575464,0.230832285598348,0.161574185416948,0.169527161948036,0.172661598937681];
GDpos=[0,52.5464818357563,-15.5382333408872,-29.3354615920032,14.4276739540331,-4.88025549503197,1.66032541722768,0.330191809872190,-16.5538767938156,-31.7371010073328,20.0137745493668,-6.19651208977336,-18.9566524437268,-15.2939019214892,-2.57721527981755,-5.36892173217916,-3.07831295375320,0.231972460008706,12.6625157385851,10.2619437333208,10.8737883019263,13.9515749606719,13.6876828639967,14.2374102621106,10.5469733933696,9.83173135272648,4.84509283400985,6.47975271357768,6.97525925801529,5.99259692112128,5.41724179666971,6.54156295068117,7.38447125943799,7.75962537674695,7.62197174401831,4.01574320028658,0,7.60334603241427,5.04109841849208,7.66824325542996,7.55816894954228,2.14119714853462,2.83588006526963,6.34698128440800,5.32679932049314,5.04274988999191,0,5.05301487552219,5.00012473901074,4.94135048479348,5.01397016134251,2.75283406471647,5.33673982600635,5.07026577782688,5.07964713725789,5.12908637048827,6.37278778058169,6.26992783891672,5.54298326691298,4.14378512448832,6.29476477720493,5.08612691714461,5.30941657226447,6.28240080949058,8.05786277959896,5.06647296782955,6.10377174554628,5.35121734085681,5.05457144726108,6.25000339296128,6.28888705871407,5.04685583254650,6.00398473872019,6.26400681249845,0,7.67667082780281,5.03092821930716,5.09715514011680,6.25763011647916,6.38214600698325];
DRpos=[0,-30.7059192212007,-28.5616538714873,-17.1395824492465,-29.0129613584026,-29.7809152778266,-27.9896952648229,-27.0042825821220,-25.6455514932598,-24.0093576143520,-28.1966954815133,-26.3403683589891,-25.5579920474850,-26.5340937592574,-26.9324677301413,-26.7052627730403,-26.7663045162891,-27.7883488503668,-28.4350265021715,-27.2715507392052,-28.1488439217540,-28.8347758507272,-29.3615593321590,-28.9571463245131,-29.6873499439350,-30.4853501708630,-30.2608795201705,-30.0969146578641,-30.0451200324958,-30.1443049236115,-30.1873316086128,-30.1552429819535,-29.8140750133483,-29.7050315305576,-30.0902773480733,-29.6514903491433,0,-29.7736660824665,-29.7642436804572,-29.9514868541651,-29.6763745146491,-29.6442954709866,-29.7279047787306,-29.8274582110621,-29.8629622099466,-29.8274026338478,0,-29.8502741628110,-29.8469376652806,-29.8471941015138,-29.8573411570111,-29.5981144629501,-29.8952365481840,-29.8585710348148,-29.8536128997531,-29.8935772574828,-29.8801498516288,-29.8816853991134,-29.8880722960335,-29.9128829799096,-29.8908353484255,-29.8368741714206,-29.8429867274149,-29.8813484035727,-29.8312176253372,-29.8474104821591,-29.8715225529751,-29.9335094816314,-29.9526180898377,-29.8818394422047,-29.8815060747076,-29.9529041901548,-29.8738626628325,-29.8830723451064,0,-29.7259148561466,-29.8644245047040,-29.9917308882808,-29.8842803829236,-29.8843942041223];

PVbus = [4.58294999999998,4.58294999999998,22.2290223650475,4.58294999999998,4.58294999999998,0.353186454098079,0.353186454098079,0.353186454098079,0.353186454098079,0.294933199807304,0.236679945516528,0.236679945516528,0.222716640463034,0.236679945516528,0.236679945516528,0.236679945516528,0.235877668604701,0.235075391692874,0.235075391692874,0.234883085917090,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23,0.23];                     
Bbus  = [241.375000000000,63.5069500000000,174.868050000000,128.106539655000,81.3450293100000,34.5835189650000,43.7615103450000,31.4679092752995,19.1743082055990,6.88070713589850,9.29360106970050,6.06161334847624,2.82962562725198,-0.402362093972283,0.231987721224261,0.231987721224261,0.231987721224261,0.173260228399414,0.173260228399414,0.173260228399414,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17,0.17];                      
GDbus = [36.8599000000000,36.8599000000000,3.04915985000002,3.04915985000002,3.04915985000002,0.789850119011703,0.789850119011703,0.205818553551239,0.205818553551239,0.0548463938797568,0.0548463938797568,0.0158200906047341,0.0158200906047341,0.00573179120817713,0.00573179120817713,0.00312396581421126,0.000516140420245392,0.000516140420245392,0.000516140420245392,0.000341879659799815,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];                      
DRbus = [-14.8144000000000,0,0,-2.77770000000000,-2.32535155500000,-1.94666805426824,-3.25930632326133,-2.44447974244599,-2.04639621638867,-1.71314059254977,-2.86831129410608,-2.15123347057956,-1.80090509989567,-3.01525540875533,-2.26144155656650,-1.89316579907964,-3.16972749739904,-2.37729562304929,-1.99015303083571,-3.33211321952823,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33,-3.33];                    

figu=figure;
plot(time,PVpos,'LineWidth',1.5);hold on; grid on; 
plot(time,Bpos,'LineWidth',1.5)
plot(time,GDpos,'LineWidth',1.5)
plot(time,DRpos,'LineWidth',1.5)

plot(time,PVbus,'-.','LineWidth',1.5)
plot(time,Bbus,'-.','LineWidth',1.5)
plot(time,GDbus,'-.','LineWidth',1.5)
plot(time,DRbus,'-.','LineWidth',1.5)

legend('PV PSO','BESS PSO','GD PSO','DR PSO','PV Proposed','BESS Proposed','GD Proposed','DR Proposed')
title(['\fontsize{14}Convergence speed of the proposed algorithm vs PSO'])
axis([0 3.1 -250 250])
xlabel('Time')
ylabel('Distance')


set(gcf,'renderer','Painters')
figu.PaperSize = [5.4 4.6];
figu.PaperPosition(1:2) = [-0.2 0.1];
print -dpdf conver.pdf
